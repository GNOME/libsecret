stages:
  - test

.test_template: &test
  script:
    - ./autogen.sh --enable-strict --disable-dependency-tracking
    - make -j$(nproc)
    - eval `dbus-launch --sh-syntax`
    - make -j$(nproc) check

fedora:rawhide:
    image: fedora:rawhide
    stage: test
    before_script:
      - dnf install -y 'dnf-command(builddep)'
      - dnf builddep -y libsecret
      - dnf install -y dbus-x11 gcc gcc-c++ gjs make python3-dbus python3-gobject redhat-rpm-config
      - dbus-uuidgen --ensure
    <<: *test
